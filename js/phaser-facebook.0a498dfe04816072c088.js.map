{"version":3,"file":"js/phaser-facebook.0a498dfe04816072c088.js","mappings":"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","sources":["webpack://@agogpixel/phaser3-demo/./node_modules/eventemitter3/index.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/AdInstance.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/Leaderboard.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/LeaderboardScore.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/Product.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/plugins/fbinstant/src/Purchase.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/src/utils/Class.js","webpack://@agogpixel/phaser3-demo/./node_modules/phaser/src/utils/object/GetFastValue.js"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * @typedef {object} AdInstance\r\n *\r\n * @property {any} instance - Represents an instance of an ad.\r\n * @property {string} placementID - The Audience Network placement ID of this ad instance.\r\n * @property {boolean} shown - Has this ad already been shown in-game?\r\n * @property {boolean} video - Is this a video ad?\r\n */\r\n\r\nvar AdInstance = function (placementID, instance, video)\r\n{\r\n    return {\r\n        instance: instance,\r\n        placementID: placementID,\r\n        shown: false,\r\n        video: video\r\n    };\r\n};\r\n\r\nmodule.exports = AdInstance;\r\n","/* eslint no-console: 0 */\r\n\r\n/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar AdInstance = require('./AdInstance');\r\nvar Class = require('../../../src/utils/Class');\r\nvar DataManager = require('../../../src/data/DataManager');\r\nvar EventEmitter = require('eventemitter3');\r\nvar Leaderboard = require('./Leaderboard');\r\nvar Product = require('./Product');\r\nvar Purchase = require('./Purchase');\r\n\r\n/**\r\n * @classdesc\r\n * The Facebook Instant Games Plugin for Phaser 3 provides a seamless bridge between Phaser\r\n * and the Facebook Instant Games API version 6.2.\r\n * \r\n * You can access this plugin via the `facebook` property in a Scene, i.e:\r\n * \r\n * ```javascript\r\n * this.facebook.getPlatform();\r\n * ```\r\n * \r\n * If this is unavailable please check to make sure you're using a build of Phaser that has\r\n * this plugin within it. You can quickly check this by looking at the dev tools console\r\n * header - the Phaser version number will have `-FB` after it if this plugin is loaded.\r\n *\r\n * If you are building your own version of Phaser then use this Webpack DefinePlugin flag:\r\n * \r\n * `\"typeof PLUGIN_FBINSTANT\": JSON.stringify(true)`\r\n * \r\n * You will find that every Instant Games API method has a mapping in this plugin.\r\n * For a full list please consult either the plugin documentation, or the 6.2 SDK documentation\r\n * at https://developers.facebook.com/docs/games/instant-games/sdk/fbinstant6.2\r\n * \r\n * Internally this plugin uses its own Data Manager to handle seamless user data updates and provides\r\n * handy functions for advertisement displaying, opening share dialogs, logging, leaderboards, purchase API requests,\r\n * loader integration and more.\r\n * \r\n * To get started with Facebook Instant Games you will need to register on Facebook and create a new Instant\r\n * Game app that has its own unique app ID. Facebook have also provided a dashboard interface for setting up\r\n * various features for your game, including leaderboards, ad requests and the payments API. There are lots\r\n * of guides on the Facebook Developers portal to assist with setting these\r\n * various systems up: https://developers.facebook.com/docs/games/instant-games/guides\r\n * \r\n * For more details follow the Quick Start guide here: https://developers.facebook.com/docs/games/instant-games\r\n *\r\n * @class FacebookInstantGamesPlugin\r\n * @memberOf Phaser\r\n * @constructor\r\n * @extends Phaser.Events.EventEmitter\r\n * @since 3.13.0\r\n *\r\n * @param {Phaser.Game} game - A reference to the Phaser.Game instance.\r\n */\r\nvar FacebookInstantGamesPlugin = new Class({\r\n\r\n    Extends: EventEmitter,\r\n\r\n    initialize:\r\n\r\n    function FacebookInstantGamesPlugin (game)\r\n    {\r\n        EventEmitter.call(this);\r\n\r\n        /**\r\n         * A reference to the Phaser.Game instance.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#game\r\n         * @type {Phaser.Game}\r\n         * @readOnly\r\n         * @since 3.13.0\r\n         */\r\n        this.game = game;\r\n\r\n        /**\r\n         * A Data Manager instance.\r\n         * It allows you to store, query and retrieve any key/value data you may need to store.\r\n         * It's also used internally by the plugin to store FBIG API data.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#data\r\n         * @type {Phaser.Data.DataManager}\r\n         * @since 3.13.0\r\n         */\r\n        this.data = new DataManager(this);\r\n\r\n        this.on('setdata', this.setDataHandler, this);\r\n        this.on('changedata', this.changeDataHandler, this);\r\n\r\n        /**\r\n         * Has the Facebook Instant Games API loaded yet?\r\n         * This is set automatically during the boot process.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#hasLoaded\r\n         * @type {boolean}\r\n         * @since 3.13.0\r\n         */\r\n        this.hasLoaded = false;\r\n\r\n        /**\r\n         * Is the Data Manager currently locked?\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#dataLocked\r\n         * @type {boolean}\r\n         * @since 3.13.0\r\n         */\r\n        this.dataLocked = false;\r\n\r\n        /**\r\n         * A list of the Facebook Instant Games APIs that are available,\r\n         * based on the given platform, context and user privacy settings.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#supportedAPIs\r\n         * @type {string[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.supportedAPIs = [];\r\n\r\n        /**\r\n         * Holds the entry point that the game was launched from.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#entryPoint\r\n         * @type {string}\r\n         * @since 3.13.0\r\n         */\r\n        this.entryPoint = '';\r\n\r\n        /**\r\n         * An object that contains any data associated with the entry point that the game was launched from.\r\n         * The contents of the object are developer-defined, and can occur from entry points on different platforms.\r\n         * This will return null for older mobile clients, as well as when there is no data associated with the particular entry point.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#entryPointData\r\n         * @type {any}\r\n         * @since 3.13.0\r\n         */\r\n        this.entryPointData = null;\r\n\r\n        /**\r\n         * A unique identifier for the current game context. This represents a specific context\r\n         * that the game is being played in (for example, a particular messenger conversation or facebook post).\r\n         * The identifier will be null if game is being played in a solo context.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#contextID\r\n         * @type {string}\r\n         * @since 3.13.0\r\n         */\r\n        this.contextID = null;\r\n\r\n        /**\r\n         * The current context in which your game is running. This can be either `null` or\r\n         * one of:\r\n         * \r\n         * `POST` - The game is running inside of a Facebook post.\r\n         * `THREAD` - The game is running inside a Facebook Messenger thread.\r\n         * `GROUP` - The game is running inside a Facebook Group.\r\n         * `SOLO` - This is the default context, the player is the only participant.\r\n         * \r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#contextType\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.contextType = null;\r\n\r\n        /**\r\n         * The current locale.\r\n         * See https://origincache.facebook.com/developers/resources/?id=FacebookLocales.xml for a complete list of supported locale values.\r\n         * Use this to determine what languages the current game should be localized with.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#locale\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.locale = null;\r\n\r\n        /**\r\n         * The platform on which the game is currently running, i.e. `IOS`.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#platform\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.platform = null;\r\n\r\n        /**\r\n         * The string representation of the Facebook Instant Games SDK version being used.\r\n         * This value is populated automatically during boot.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#version\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.version = null;\r\n\r\n        /**\r\n         * Holds the id of the player. This is a string based ID, the same as `FBInstant.player.getID()`.\r\n         * This value is populated automatically during boot if the API is supported.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#playerID\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.playerID = null;\r\n\r\n        /**\r\n         * The player's localized display name.\r\n         * This value is populated automatically during boot if the API is supported.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#playerName\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.playerName = null;\r\n\r\n        /**\r\n         * A url to the player's public profile photo. The photo will always be a square, and with dimensions\r\n         * of at least 200x200. When rendering it in the game, the exact dimensions should never be assumed to be constant.\r\n         * It's recommended to always scale the image to a desired size before rendering.\r\n         * This value is populated automatically during boot if the API is supported.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#playerPhotoURL\r\n         * @type {?string}\r\n         * @since 3.13.0\r\n         */\r\n        this.playerPhotoURL = null;\r\n\r\n        /**\r\n         * Whether a player can subscribe to the game bot or not.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#playerCanSubscribeBot\r\n         * @type {boolean}\r\n         * @since 3.13.0\r\n         */\r\n        this.playerCanSubscribeBot = false;\r\n\r\n        /**\r\n         * Does the current platform and context allow for use of the payments API?\r\n         * Currently this is only available on Facebook.com and Android 6+.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#paymentsReady\r\n         * @type {boolean}\r\n         * @since 3.13.0\r\n         */\r\n        this.paymentsReady = false;\r\n\r\n        /**\r\n         * The set of products that are registered to the game.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#catalog\r\n         * @type {Product[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.catalog = [];\r\n\r\n        /**\r\n         * Contains all of the player's unconsumed purchases.\r\n         * The game must fetch the current player's purchases as soon as the client indicates that it is ready to perform payments-related operations,\r\n         * i.e. at game start. The game can then process and consume any purchases that are waiting to be consumed.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#purchases\r\n         * @type {Purchase[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.purchases = [];\r\n\r\n        /**\r\n         * Contains all of the leaderboard data, as populated by the `getLeaderboard()` method.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#leaderboards\r\n         * @type {Phaser.FacebookInstantGamesLeaderboard[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.leaderboards = {};\r\n\r\n        /**\r\n         * Contains AdInstance objects, as created by the `preloadAds()` method.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesPlugin#ads\r\n         * @type {AdInstance[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.ads = [];\r\n    },\r\n\r\n    /**\r\n     * Internal set data handler.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#setDataHandler\r\n     * @private\r\n     * @since 3.13.0\r\n     *\r\n     * @param {Phaser.Data.DataManager} parent - The parent Data Manager instance.\r\n     * @param {string} key - The key of the data.\r\n     * @param {any} value - The value of the data.\r\n     */\r\n    setDataHandler: function (parent, key, value)\r\n    {\r\n        if (this.dataLocked)\r\n        {\r\n            return;\r\n        }\r\n\r\n        var data = {};\r\n\r\n        data[key] = value;\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.setDataAsync(data).then(function ()\r\n        {\r\n            _this.emit('savedata', data);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Internal change data handler.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#changeDataHandler\r\n     * @private\r\n     * @since 3.13.0\r\n     *\r\n     * @param {Phaser.Data.DataManager} parent - The parent Data Manager instance.\r\n     * @param {string} key - The key of the data.\r\n     * @param {any} value - The value of the data.\r\n     */\r\n    changeDataHandler: function (parent, key, value)\r\n    {\r\n        if (this.dataLocked)\r\n        {\r\n            return;\r\n        }\r\n\r\n        var data = {};\r\n\r\n        data[key] = value;\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.setDataAsync(data).then(function ()\r\n        {\r\n            _this.emit('savedata', data);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Call this method from your `Scene.preload` in order to sync the load progress\r\n     * of the Phaser Loader with the Facebook Instant Games loader display, i.e.:\r\n     * \r\n     * ```javascript\r\n     * this.facebook.showLoadProgress(this);\r\n     * this.facebook.once('startgame', this.startGame, this);\r\n     * ```\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#showLoadProgress\r\n     * @since 3.13.0\r\n     *\r\n     * @param {Phaser.Scene} scene - The Scene for which you want to show loader progress for.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    showLoadProgress: function (scene)\r\n    {\r\n        scene.load.on('progress', function (value)\r\n        {\r\n            if (!this.hasLoaded)\r\n            {\r\n                FBInstant.setLoadingProgress(value * 100);\r\n            }\r\n\r\n        }, this);\r\n\r\n        scene.load.on('complete', function ()\r\n        {\r\n            if (!this.hasLoaded)\r\n            {\r\n                this.hasLoaded = true;\r\n\r\n                FBInstant.startGameAsync().then(this.gameStartedHandler.bind(this));\r\n            }\r\n            \r\n        }, this);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method is called automatically when the game has finished loading,\r\n     * if you used the `showLoadProgress` method. If your game doesn't need to\r\n     * load any assets, or you're managing the load yourself, then call this\r\n     * method directly to start the API running.\r\n     * \r\n     * When the API has finished starting this plugin will emit a `startgame` event\r\n     * which you should listen for.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#gameStarted\r\n     * @since 3.13.0\r\n     */\r\n    gameStarted: function ()\r\n    {\r\n        if (!this.hasLoaded)\r\n        {\r\n            this.hasLoaded = true;\r\n\r\n            FBInstant.startGameAsync().then(this.gameStartedHandler.bind(this));\r\n        }\r\n        else\r\n        {\r\n            this.gameStartedHandler();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * The internal gameStarted handler.\r\n     * \r\n     * @method Phaser.FacebookInstantGamesPlugin#gameStartedHandler\r\n     * @private\r\n     * @since 3.20.0\r\n     */\r\n    gameStartedHandler: function ()\r\n    {\r\n        var APIs = FBInstant.getSupportedAPIs();\r\n\r\n        var supported = {};\r\n\r\n        var dotToUpper = function (match)\r\n        {\r\n            return match[1].toUpperCase();\r\n        };\r\n\r\n        APIs.forEach(function (api)\r\n        {\r\n            api = api.replace(/\\../g, dotToUpper);\r\n\r\n            supported[api] = true;\r\n        });\r\n\r\n        this.supportedAPIs = supported;\r\n\r\n        this.getID();\r\n        this.getType();\r\n        this.getLocale();\r\n        this.getPlatform();\r\n        this.getSDKVersion();\r\n\r\n        this.getPlayerID();\r\n        this.getPlayerName();\r\n        this.getPlayerPhotoURL();\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.onPause(function ()\r\n        {\r\n            _this.emit('pause');\r\n        });\r\n\r\n        FBInstant.getEntryPointAsync().then(function (entrypoint)\r\n        {\r\n            _this.entryPoint = entrypoint;\r\n            _this.entryPointData = FBInstant.getEntryPointData();\r\n\r\n            _this.emit('startgame');\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        //  Facebook.com and Android 6 only\r\n        if (this.supportedAPIs.paymentsPurchaseAsync)\r\n        {\r\n            FBInstant.payments.onReady(function ()\r\n            {\r\n                _this.paymentsReady = true;\r\n\r\n            }).catch(function (e)\r\n            {\r\n                console.warn(e);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks to see if a given Facebook Instant Games API is available or not.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#checkAPI\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} api - The API to check for, i.e. `player.getID`.\r\n     * \r\n     * @return {boolean} `true` if the API is supported, otherwise `false`.\r\n     */\r\n    checkAPI: function (api)\r\n    {\r\n        if (!this.supportedAPIs[api])\r\n        {\r\n            return false;\r\n        }\r\n        else\r\n        {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the unique identifier for the current game context. This represents a specific context\r\n     * that the game is being played in (for example, a particular messenger conversation or facebook post).\r\n     * The identifier will be null if game is being played in a solo context.\r\n     * \r\n     * It is only populated if `contextGetID` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getID\r\n     * @since 3.13.0\r\n     * \r\n     * @return {string} The context ID.\r\n     */\r\n    getID: function ()\r\n    {\r\n        if (!this.contextID && this.supportedAPIs.contextGetID)\r\n        {\r\n            this.contextID = FBInstant.context.getID();\r\n        }\r\n\r\n        return this.contextID;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context in which your game is running. This can be either `null` or one of:\r\n     * \r\n     * `POST` - The game is running inside of a Facebook post.\r\n     * `THREAD` - The game is running inside a Facebook Messenger thread.\r\n     * `GROUP` - The game is running inside a Facebook Group.\r\n     * `SOLO` - This is the default context, the player is the only participant.\r\n     * \r\n     * It is only populated if `contextGetType` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getType\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The context type.\r\n     */\r\n    getType: function ()\r\n    {\r\n        if (!this.contextType && this.supportedAPIs.contextGetType)\r\n        {\r\n            this.contextType = FBInstant.context.getType();\r\n        }\r\n\r\n        return this.contextType;\r\n    },\r\n\r\n    /**\r\n     * Returns the current locale.\r\n     * See https://origincache.facebook.com/developers/resources/?id=FacebookLocales.xml for a complete list of supported locale values.\r\n     * Use this to determine what languages the current game should be localized with.\r\n     * It is only populated if `getLocale` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getLocale\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The current locale.\r\n     */\r\n    getLocale: function ()\r\n    {\r\n        if (!this.locale && this.supportedAPIs.getLocale)\r\n        {\r\n            this.locale = FBInstant.getLocale();\r\n        }\r\n\r\n        return this.locale;\r\n    },\r\n\r\n    /**\r\n     * Returns the platform on which the game is currently running, i.e. `IOS`.\r\n     * It is only populated if `getPlatform` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPlatform\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The current platform.\r\n     */\r\n    getPlatform: function ()\r\n    {\r\n        if (!this.platform && this.supportedAPIs.getPlatform)\r\n        {\r\n            this.platform = FBInstant.getPlatform();\r\n        }\r\n\r\n        return this.platform;\r\n    },\r\n\r\n    /**\r\n     * Returns the string representation of the Facebook Instant Games SDK version being used.\r\n     * It is only populated if `getSDKVersion` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getSDKVersion\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The sdk version.\r\n     */\r\n    getSDKVersion: function ()\r\n    {\r\n        if (!this.version && this.supportedAPIs.getSDKVersion)\r\n        {\r\n            this.version = FBInstant.getSDKVersion();\r\n        }\r\n\r\n        return this.version;\r\n    },\r\n\r\n    /**\r\n     * Returns the id of the player. This is a string based ID, the same as `FBInstant.player.getID()`.\r\n     * It is only populated if `playerGetID` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPlayerID\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The player ID.\r\n     */\r\n    getPlayerID: function ()\r\n    {\r\n        if (!this.playerID && this.supportedAPIs.playerGetID)\r\n        {\r\n            this.playerID = FBInstant.player.getID();\r\n        }\r\n\r\n        return this.playerID;\r\n    },\r\n\r\n    /**\r\n     * Returns the player's localized display name.\r\n     * It is only populated if `playerGetName` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPlayerName\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The player's localized display name.\r\n     */\r\n    getPlayerName: function ()\r\n    {\r\n        if (!this.playerName && this.supportedAPIs.playerGetName)\r\n        {\r\n            this.playerName = FBInstant.player.getName();\r\n        }\r\n\r\n        return this.playerName;\r\n    },\r\n\r\n    /**\r\n     * Returns the url to the player's public profile photo. The photo will always be a square, and with dimensions\r\n     * of at least 200x200. When rendering it in the game, the exact dimensions should never be assumed to be constant.\r\n     * It's recommended to always scale the image to a desired size before rendering.\r\n     * It is only populated if `playerGetPhoto` is in the list of supported APIs.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPlayerPhotoURL\r\n     * @since 3.13.0\r\n     * \r\n     * @return {?string} The player's photo url.\r\n     */\r\n    getPlayerPhotoURL: function ()\r\n    {\r\n        if (!this.playerPhotoURL && this.supportedAPIs.playerGetPhoto)\r\n        {\r\n            this.playerPhotoURL = FBInstant.player.getPhoto();\r\n        }\r\n\r\n        return this.playerPhotoURL;\r\n    },\r\n\r\n    /**\r\n     * Load the player's photo and store it in the Texture Manager, ready for use in-game.\r\n     * \r\n     * This method works by using a Scene Loader instance and then asking the Loader to\r\n     * retrieve the image.\r\n     * \r\n     * When complete the plugin will emit a `photocomplete` event, along with the key of the photo.\r\n     * \r\n     * ```javascript\r\n     * this.facebook.loadPlayerPhoto(this, 'player').once('photocomplete', function (key) {\r\n     *   this.add.image(x, y, 'player');\r\n     * }, this);\r\n     * ```\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#loadPlayerPhoto\r\n     * @since 3.13.0\r\n     * \r\n     * @param {Phaser.Scene} scene - The Scene that will be responsible for loading this photo.\r\n     * @param {string} key - The key to use when storing the photo in the Texture Manager.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    loadPlayerPhoto: function (scene, key)\r\n    {\r\n        if (this.playerPhotoURL)\r\n        {\r\n            scene.load.setCORS('anonymous');\r\n    \r\n            scene.load.image(key, this.playerPhotoURL);\r\n    \r\n            scene.load.once('filecomplete-image-' + key, function ()\r\n            {\r\n                this.emit('photocomplete', key);\r\n\r\n            }, this);\r\n    \r\n            scene.load.start();\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Checks if the current player can subscribe to the game bot.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they can subscribe, the `playerCanSubscribeBot` property is set to `true`\r\n     * and this plugin will emit the `cansubscribebot` event.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `cansubscribebotfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#canSubscribeBot\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    canSubscribeBot: function ()\r\n    {\r\n        if (this.supportedAPIs.playerCanSubscribeBotAsync)\r\n        {\r\n            var _this = this;\r\n\r\n            FBInstant.player.canSubscribeBotAsync().then(function ()\r\n            {\r\n                _this.playerCanSubscribeBot = true;\r\n\r\n                _this.emit('cansubscribebot');\r\n\r\n            }).catch(function (e)\r\n            {\r\n                _this.emit('cansubscribebotfail', e);\r\n            });\r\n        }\r\n        else\r\n        {\r\n            this.emit('cansubscribebotfail');\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Subscribes the current player to the game bot.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `subscribebot` event.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `subscribebotfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#subscribeBot\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    subscribeBot: function ()\r\n    {\r\n        if (this.playerCanSubscribeBot)\r\n        {\r\n            var _this = this;\r\n\r\n            FBInstant.player.subscribeBotAsync().then(function ()\r\n            {\r\n                _this.emit('subscribebot');\r\n\r\n            }).catch(function (e)\r\n            {\r\n                _this.emit('subscribebotfail', e);\r\n            });\r\n        }\r\n        else\r\n        {\r\n            this.emit('subscribebotfail');\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Gets the associated data from the player based on the given key, or array of keys.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes the data is set into this plugins Data Manager and the\r\n     * `getdata` event will be emitted.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getData\r\n     * @since 3.13.0\r\n     * \r\n     * @param {(string|string[])} keys - The key/s of the data to retrieve.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getData: function (keys)\r\n    {\r\n        if (!this.checkAPI('playerGetDataAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (!Array.isArray(keys))\r\n        {\r\n            keys = [ keys ];\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.getDataAsync(keys).then(function (data)\r\n        {\r\n            _this.dataLocked = true;\r\n\r\n            for (var key in data)\r\n            {\r\n                _this.data.set(key, data[key]);\r\n            }\r\n\r\n            _this.dataLocked = false;\r\n\r\n            _this.emit('getdata', data);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Set data to be saved to the designated cloud storage of the current player. The game can store up to 1MB of data for each unique player.\r\n     * \r\n     * The data save is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * Data managed via this plugins Data Manager instance is automatically synced with Facebook. However, you can call this\r\n     * method directly if you need to replace the data object directly.\r\n     * \r\n     * When the APIs `setDataAsync` call resolves it will emit the `savedata` event from this plugin. If the call fails for some\r\n     * reason it will emit `savedatafail` instead.\r\n     * \r\n     * The call resolving does not necessarily mean that the input has already been persisted. Rather, it means that the data was valid and\r\n     * has been scheduled to be saved. It also guarantees that all values that were set are now available in `getData`.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#saveData\r\n     * @since 3.13.0\r\n     * \r\n     * @param {object} data - An object containing a set of key-value pairs that should be persisted to cloud storage.\r\n     * The object must contain only serializable values - any non-serializable values will cause the entire modification to be rejected.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    saveData: function (data)\r\n    {\r\n        if (!this.checkAPI('playerSetDataAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.setDataAsync(data).then(function ()\r\n        {\r\n            _this.emit('savedata', data);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('savedatafail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Immediately flushes any changes to the player data to the designated cloud storage.\r\n     * This function is expensive, and should primarily be used for critical changes where persistence needs to be immediate\r\n     * and known by the game. Non-critical changes should rely on the platform to persist them in the background.\r\n     * NOTE: Calls to player.setDataAsync will be rejected while this function's result is pending.\r\n     * \r\n     * Data managed via this plugins Data Manager instance is automatically synced with Facebook. However, you can call this\r\n     * method directly if you need to flush the data directly.\r\n     * \r\n     * When the APIs `flushDataAsync` call resolves it will emit the `flushdata` event from this plugin. If the call fails for some\r\n     * reason it will emit `flushdatafail` instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#flushData\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    flushData: function ()\r\n    {\r\n        if (!this.checkAPI('playerFlushDataAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.flushDataAsync().then(function ()\r\n        {\r\n            _this.emit('flushdata');\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('flushdatafail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Retrieve stats from the designated cloud storage of the current player.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes the `getstats` event will be emitted along with the data object returned.\r\n     * \r\n     * If the call fails, i.e. it's not in the list of supported APIs, or the request was rejected,\r\n     * it will emit a `getstatsfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getStats\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string[]} [keys] - An optional array of unique keys to retrieve stats for. If the function is called without it, it will fetch all stats.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getStats: function (keys)\r\n    {\r\n        if (!this.checkAPI('playerGetStatsAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.getStatsAsync(keys).then(function (data)\r\n        {\r\n            _this.emit('getstats', data);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('getstatsfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Save the stats of the current player to the designated cloud storage.\r\n     * \r\n     * Stats in the Facebook Instant Games API are purely numerical values paired with a string-based key. Only numbers can be saved as stats,\r\n     * all other data types will be ignored.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes the `savestats` event will be emitted along with the data object returned.\r\n     * \r\n     * If the call fails, i.e. it's not in the list of supported APIs, or the request was rejected,\r\n     * it will emit a `savestatsfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#saveStats\r\n     * @since 3.13.0\r\n     * \r\n     * @param {object} data - An object containing a set of key-value pairs that should be persisted to cloud storage as stats. Note that only numerical values are stored.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    saveStats: function (data)\r\n    {\r\n        if (!this.checkAPI('playerSetStatsAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var output = {};\r\n\r\n        for (var key in data)\r\n        {\r\n            if (typeof data[key] === 'number')\r\n            {\r\n                output[key] = data[key];\r\n            }\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.setStatsAsync(output).then(function ()\r\n        {\r\n            _this.emit('savestats', output);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('savestatsfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Increment the stats of the current player and save them to the designated cloud storage.\r\n     * \r\n     * Stats in the Facebook Instant Games API are purely numerical values paired with a string-based key. Only numbers can be saved as stats,\r\n     * all other data types will be ignored.\r\n     * \r\n     * The data object provided for this call should contain offsets for how much to modify the stats by:\r\n     * \r\n     * ```javascript\r\n     * this.facebook.incStats({\r\n     *     level: 1,\r\n     *     zombiesSlain: 17,\r\n     *     rank: -1\r\n     * });\r\n     * ```\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes the `incstats` event will be emitted along with the data object returned.\r\n     * \r\n     * If the call fails, i.e. it's not in the list of supported APIs, or the request was rejected,\r\n     * it will emit a `incstatsfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#incStats\r\n     * @since 3.13.0\r\n     * \r\n     * @param {object} data - An object containing a set of key-value pairs indicating how much to increment each stat in cloud storage. Note that only numerical values are processed.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    incStats: function (data)\r\n    {\r\n        if (!this.checkAPI('playerIncrementStatsAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var output = {};\r\n\r\n        for (var key in data)\r\n        {\r\n            if (typeof data[key] === 'number')\r\n            {\r\n                output[key] = data[key];\r\n            }\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.incrementStatsAsync(output).then(function (stats)\r\n        {\r\n            _this.emit('incstats', stats);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('incstatsfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Sets the data associated with the individual gameplay session for the current context.\r\n     * \r\n     * This function should be called whenever the game would like to update the current session data.\r\n     * \r\n     * This session data may be used to populate a variety of payloads, such as game play webhooks.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#saveSession\r\n     * @since 3.13.0\r\n     * \r\n     * @param {object} data - An arbitrary data object, which must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    saveSession: function (data)\r\n    {\r\n        if (!this.checkAPI('setSessionData'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var test = JSON.stringify(data);\r\n\r\n        if (test.length <= 1000)\r\n        {\r\n            FBInstant.setSessionData(data);\r\n        }\r\n        else\r\n        {\r\n            console.warn('Session data too long. Max 1000 chars.');\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This invokes a dialog to let the user share specified content, either as a message in Messenger or as a post on the user's timeline.\r\n     * \r\n     * A blob of data can be attached to the share which every game session launched from the share will be able to access via the `this.entryPointData` property.\r\n     * \r\n     * This data must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * When this method is called you should consider your game paused. Listen out for the `resume` event from this plugin to know when the dialog has been closed.\r\n     * \r\n     * The user may choose to cancel the share action and close the dialog. The resulting `resume` event will be dispatched regardless if the user actually shared the content or not.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#openShare\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} text - A text message to be shared.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {string} [frame] - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {object} [sessionData] - A blob of data to attach to the share.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    openShare: function (text, key, frame, sessionData)\r\n    {\r\n        return this._share('SHARE', text, key, frame, sessionData);\r\n    },\r\n\r\n    /**\r\n     * This invokes a dialog to let the user invite a friend to play this game, either as a message in Messenger or as a post on the user's timeline.\r\n     * \r\n     * A blob of data can be attached to the share which every game session launched from the share will be able to access via the `this.entryPointData` property.\r\n     * \r\n     * This data must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * When this method is called you should consider your game paused. Listen out for the `resume` event from this plugin to know when the dialog has been closed.\r\n     * \r\n     * The user may choose to cancel the share action and close the dialog. The resulting `resume` event will be dispatched regardless if the user actually shared the content or not.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#openInvite\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} text - A text message to be shared.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {string} [frame] - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {object} [sessionData] - A blob of data to attach to the share.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    openInvite: function (text, key, frame, sessionData)\r\n    {\r\n        return this._share('INVITE', text, key, frame, sessionData);\r\n    },\r\n\r\n    /**\r\n     * This invokes a dialog to let the user share specified content, either as a message in Messenger or as a post on the user's timeline.\r\n     * \r\n     * A blob of data can be attached to the share which every game session launched from the share will be able to access via the `this.entryPointData` property.\r\n     * \r\n     * This data must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * When this method is called you should consider your game paused. Listen out for the `resume` event from this plugin to know when the dialog has been closed.\r\n     * \r\n     * The user may choose to cancel the share action and close the dialog. The resulting `resume` event will be dispatched regardless if the user actually shared the content or not.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#openRequest\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} text - A text message to be shared.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {string} [frame] - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {object} [sessionData] - A blob of data to attach to the share.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    openRequest: function (text, key, frame, sessionData)\r\n    {\r\n        return this._share('REQUEST', text, key, frame, sessionData);\r\n    },\r\n\r\n    /**\r\n     * This invokes a dialog to let the user share specified content, either as a message in Messenger or as a post on the user's timeline.\r\n     * \r\n     * A blob of data can be attached to the share which every game session launched from the share will be able to access via the `this.entryPointData` property.\r\n     * \r\n     * This data must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * When this method is called you should consider your game paused. Listen out for the `resume` event from this plugin to know when the dialog has been closed.\r\n     * \r\n     * The user may choose to cancel the share action and close the dialog. The resulting `resume` event will be dispatched regardless if the user actually shared the content or not.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#openChallenge\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} text - A text message to be shared.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {string} [frame] - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {object} [sessionData] - A blob of data to attach to the share.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    openChallenge: function (text, key, frame, sessionData)\r\n    {\r\n        return this._share('CHALLENGE', text, key, frame, sessionData);\r\n    },\r\n\r\n    /**\r\n     * Internal share handler.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#_share\r\n     * @private\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} intent - (\"INVITE\" | \"REQUEST\" | \"CHALLENGE\" | \"SHARE\") Indicates the intent of the share.\r\n     * @param {string} text - A text message to be shared.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {string} [frame] - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {object} [sessionData] - A blob of data to attach to the share.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    _share: function (intent, text, key, frame, sessionData)\r\n    {\r\n        if (!this.checkAPI('shareAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (sessionData === undefined) { sessionData = {}; }\r\n\r\n        if (key)\r\n        {\r\n            var imageData = this.game.textures.getBase64(key, frame);\r\n        }\r\n\r\n        // intent (\"INVITE\" | \"REQUEST\" | \"CHALLENGE\" | \"SHARE\") Indicates the intent of the share.\r\n        // image string A base64 encoded image to be shared.\r\n        // text string A text message to be shared.\r\n        // data Object? A blob of data to attach to the share. All game sessions launched from the share will be able to access this blob through FBInstant.getEntryPointData().\r\n\r\n        var payload = {\r\n            intent: intent,\r\n            image: imageData,\r\n            text: text,\r\n            data: sessionData\r\n        };\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.shareAsync(payload).then(function ()\r\n        {\r\n            _this.emit('resume');\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This function determines whether the number of participants in the current game context is between a given minimum and maximum, inclusive.\r\n     * If one of the bounds is null only the other bound will be checked against.\r\n     * It will always return the original result for the first call made in a context in a given game play session.\r\n     * Subsequent calls, regardless of arguments, will return the answer to the original query until a context change occurs and the query result is reset.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#isSizeBetween\r\n     * @since 3.13.0\r\n     * \r\n     * @param {integer} [min] - The minimum bound of the context size query.\r\n     * @param {integer} [max] - The maximum bound of the context size query.\r\n     * \r\n     * @return {object} The Context Size Response object in the format: `{answer: boolean, minSize: number?, maxSize: number?}`.\r\n     */\r\n    isSizeBetween: function (min, max)\r\n    {\r\n        if (!this.checkAPI('contextIsSizeBetween'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        return FBInstant.context.isSizeBetween(min, max);\r\n    },\r\n\r\n    /**\r\n     * Request a switch into a specific context. If the player does not have permission to enter that context,\r\n     * or if the player does not provide permission for the game to enter that context, this will emit a `switchfail` event.\r\n     * \r\n     * Otherwise, the plugin will emit the `switch` event when the game has switched into the specified context.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#switchContext\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} contextID - The ID of the desired context.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    switchContext: function (contextID)\r\n    {\r\n        if (!this.checkAPI('contextSwitchAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (contextID !== this.contextID)\r\n        {\r\n            var _this = this;\r\n\r\n            FBInstant.context.switchAsync(contextID).then(function ()\r\n            {\r\n                _this.contextID = FBInstant.context.getID();\r\n\r\n                _this.emit('switch', _this.contextID);\r\n\r\n            }).catch(function (e)\r\n            {\r\n                _this.emit('switchfail', e);\r\n            });\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * A filter that may be applied to a Context Choose operation.\r\n     * \r\n     * 'NEW_CONTEXT_ONLY' - Prefer to only surface contexts the game has not been played in before.\r\n     * 'INCLUDE_EXISTING_CHALLENGES' - Include the \"Existing Challenges\" section, which surfaces actively played-in contexts that the player is a part of.\r\n     * 'NEW_PLAYERS_ONLY' - In sections containing individuals, prefer people who have not played the game.\r\n     * \r\n     * @typedef {string} ContextFilter\r\n     */\r\n\r\n    /**\r\n     * A configuration object that may be applied to a Context Choose operation.\r\n     * \r\n     * @typedef {object} ChooseContextConfig\r\n     * @property {ContextFilter[]} [filters] - The set of filters to apply to the context suggestions: 'NEW_CONTEXT_ONLY', 'INCLUDE_EXISTING_CHALLENGES' or 'NEW_PLAYERS_ONLY'.\r\n     * @property {number} [maxSize] - The maximum number of participants that a suggested context should ideally have.\r\n     * @property {number} [minSize] - The minimum number of participants that a suggested context should ideally have.\r\n     */\r\n\r\n    /**\r\n     * Opens a context selection dialog for the player. If the player selects an available context,\r\n     * the client will attempt to switch into that context, and emit the `choose` event if successful.\r\n     * Otherwise, if the player exits the menu or the client fails to switch into the new context, the `choosefail` event will be emitted.\r\n     * \r\n     * @method Phaser.FacebookInstantGamesPlugin#chooseContext\r\n     * @since 3.13.0\r\n     * \r\n     * @param {ChooseContextConfig} [options] - An object specifying conditions on the contexts that should be offered.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    chooseContext: function (options)\r\n    {\r\n        if (!this.checkAPI('contextChooseAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.context.chooseAsync(options).then(function ()\r\n        {\r\n            _this.contextID = FBInstant.context.getID();\r\n            _this.emit('choose', _this.contextID);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('choosefail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Attempts to create or switch into a context between a specified player and the current player.\r\n     * This plugin will emit the `create` event once the context switch is completed.\r\n     * If the API call fails, such as if the player listed is not a Connected Player of the current player or if the\r\n     * player does not provide permission to enter the new context, then the plugin will emit a 'createfail' event.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#createContext\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} playerID - ID of the player.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    createContext: function (playerID)\r\n    {\r\n        if (!this.checkAPI('contextCreateAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.context.createAsync(playerID).then(function ()\r\n        {\r\n            _this.contextID = FBInstant.context.getID();\r\n            _this.emit('create', _this.contextID);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('createfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Fetches an array of ConnectedPlayer objects containing information about active players\r\n     * (people who played the game in the last 90 days) that are connected to the current player.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `players` event along\r\n     * with the player data.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `playersfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPlayers\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getPlayers: function ()\r\n    {\r\n        if (!this.checkAPI('playerGetConnectedPlayersAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.player.getConnectedPlayersAsync().then(function (players)\r\n        {\r\n            _this.emit('players', players);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('playersfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Fetches the game's product catalog.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `getcatalog` event along\r\n     * with the catalog data.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `getcatalogfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getCatalog\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getCatalog: function ()\r\n    {\r\n        if (!this.paymentsReady)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n        var catalog = this.catalog;\r\n\r\n        FBInstant.payments.getCatalogAsync().then(function (data)\r\n        {\r\n            catalog = [];\r\n\r\n            data.forEach(function (item)\r\n            {\r\n                catalog.push(Product(item));\r\n            });\r\n\r\n            _this.emit('getcatalog', catalog);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('getcatalogfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Fetches a single Product from the game's product catalog.\r\n     * \r\n     * The product catalog must have been populated using `getCatalog` prior to calling this method.\r\n     * \r\n     * Use this to look-up product details based on a purchase list.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getProduct\r\n     * @since 3.17.0\r\n     * \r\n     * @param {string} productID - The Product ID of the item to get from the catalog.\r\n     * \r\n     * @return {?Product} The Product from the catalog, or `null` if it couldn't be found or the catalog isn't populated.\r\n     */\r\n    getProduct: function (productID)\r\n    {\r\n        for (var i = 0; i < this.catalog.length; i++)\r\n        {\r\n            if (this.catalog[i].productID === productID)\r\n            {\r\n                return this.catalog[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Begins the purchase flow for a specific product.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `purchase` event along\r\n     * with the purchase data.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `purchasefail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#purchase\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} productID - The identifier of the product to purchase.\r\n     * @param {string} [developerPayload] - An optional developer-specified payload, to be included in the returned purchase's signed request.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    purchase: function (productID, developerPayload)\r\n    {\r\n        if (!this.paymentsReady)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var config = {productID: productID};\r\n\r\n        if (developerPayload)\r\n        {\r\n            config.developerPayload = developerPayload;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.payments.purchaseAsync(config).then(function (data)\r\n        {\r\n            var purchase = Purchase(data);\r\n\r\n            _this.emit('purchase', purchase);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('purchasefail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Fetches all of the player's unconsumed purchases. The game must fetch the current player's purchases\r\n     * as soon as the client indicates that it is ready to perform payments-related operations,\r\n     * i.e. at game start. The game can then process and consume any purchases that are waiting to be consumed.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `getpurchases` event along\r\n     * with the purchase data.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `getpurchasesfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getPurchases\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getPurchases: function ()\r\n    {\r\n        if (!this.paymentsReady)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n        var purchases = this.purchases;\r\n\r\n        FBInstant.payments.getPurchasesAsync().then(function (data)\r\n        {\r\n            purchases = [];\r\n\r\n            data.forEach(function (item)\r\n            {\r\n                purchases.push(Purchase(item));\r\n            });\r\n\r\n            _this.emit('getpurchases', purchases);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('getpurchasesfail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Consumes a specific purchase belonging to the current player. Before provisioning a product's effects to the player,\r\n     * the game should request the consumption of the purchased product. Once the purchase is successfully consumed,\r\n     * the game should immediately provide the player with the effects of their purchase.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If they are successfully subscribed this plugin will emit the `consumepurchase` event along\r\n     * with the purchase data.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `consumepurchasefail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#consumePurchase\r\n     * @since 3.17.0\r\n     * \r\n     * @param {string} purchaseToken - The purchase token of the purchase that should be consumed.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    consumePurchase: function (purchaseToken)\r\n    {\r\n        if (!this.paymentsReady)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.payments.consumePurchaseAsync(purchaseToken).then(function ()\r\n        {\r\n            _this.emit('consumepurchase', purchaseToken);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('consumepurchasefail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Informs Facebook of a custom update that occurred in the game.\r\n     * This will temporarily yield control to Facebook and Facebook will decide what to do based on what the update is.\r\n     * Once Facebook returns control to the game the plugin will emit an `update` or `updatefail` event.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * The `text` parameter is an update payload with the following structure:\r\n     * \r\n     * ```\r\n     * text: {\r\n     *     default: 'X just invaded Y\\'s village!',\r\n     *     localizations: {\r\n     *         ar_AR: 'X \\u0641\\u0642\\u0637 \\u063A\\u0632\\u062A ' +\r\n     *         '\\u0642\\u0631\\u064A\\u0629 Y!',\r\n     *         en_US: 'X just invaded Y\\'s village!',\r\n     *         es_LA: '\\u00A1X acaba de invadir el pueblo de Y!',\r\n     *     }\r\n     * }\r\n     * ```\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#update\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} cta - The call to action text.\r\n     * @param {object} text - The text object.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {?(string|integer)} frame - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {string} template - The update template key.\r\n     * @param {object} updateData - The update data object payload.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    update: function (cta, text, key, frame, template, updateData)\r\n    {\r\n        return this._update('CUSTOM', cta, text, key, frame, template, updateData);\r\n    },\r\n\r\n    /**\r\n     * Informs Facebook of a leaderboard update that occurred in the game.\r\n     * This will temporarily yield control to Facebook and Facebook will decide what to do based on what the update is.\r\n     * Once Facebook returns control to the game the plugin will emit an `update` or `updatefail` event.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * The `text` parameter is an update payload with the following structure:\r\n     * \r\n     * ```\r\n     * text: {\r\n     *     default: 'X just invaded Y\\'s village!',\r\n     *     localizations: {\r\n     *         ar_AR: 'X \\u0641\\u0642\\u0637 \\u063A\\u0632\\u062A ' +\r\n     *         '\\u0642\\u0631\\u064A\\u0629 Y!',\r\n     *         en_US: 'X just invaded Y\\'s village!',\r\n     *         es_LA: '\\u00A1X acaba de invadir el pueblo de Y!',\r\n     *     }\r\n     * }\r\n     * ```\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#updateLeaderboard\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} cta - The call to action text.\r\n     * @param {object} text - The text object.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {?(string|integer)} frame - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {string} template - The update template key.\r\n     * @param {object} updateData - The update data object payload.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    updateLeaderboard: function (cta, text, key, frame, template, updateData)\r\n    {\r\n        return this._update('LEADERBOARD', cta, text, key, frame, template, updateData);\r\n    },\r\n\r\n    /**\r\n     * Internal update handler.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#_update\r\n     * @private\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} action - The update action.\r\n     * @param {string} cta - The call to action text.\r\n     * @param {object} text - The text object.\r\n     * @param {string} key - The key of the texture to use as the share image.\r\n     * @param {?(string|integer)} frame - The frame of the texture to use as the share image. Set to `null` if you don't require a frame, but do need to set session data.\r\n     * @param {string} template - The update template key.\r\n     * @param {object} updateData - The update data object payload.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    _update: function (action, cta, text, key, frame, template, updateData)\r\n    {\r\n        if (!this.checkAPI('shareAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (cta === undefined) { cta = ''; }\r\n\r\n        if (typeof text === 'string')\r\n        {\r\n            text = {default: text};\r\n        }\r\n\r\n        if (updateData === undefined) { updateData = {}; }\r\n\r\n        if (key)\r\n        {\r\n            var imageData = this.game.textures.getBase64(key, frame);\r\n        }\r\n\r\n        var payload = {\r\n            action: action,\r\n            cta: cta,\r\n            image: imageData,\r\n            text: text,\r\n            template: template,\r\n            data: updateData,\r\n            strategy: 'IMMEDIATE',\r\n            notification: 'NO_PUSH'\r\n        };\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.updateAsync(payload).then(function ()\r\n        {\r\n            _this.emit('update');\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('updatefail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Request that the client switch to a different Instant Game.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If the game switches successfully this plugin will emit the `switchgame` event and the client will load the new game.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `switchgamefail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#switchGame\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} appID - The Application ID of the Instant Game to switch to. The application must be an Instant Game, and must belong to the same business as the current game.\r\n     * @param {object} [data] - An optional data payload. This will be set as the entrypoint data for the game being switched to. Must be less than or equal to 1000 characters when stringified.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    switchGame: function (appID, data)\r\n    {\r\n        if (!this.checkAPI('switchGameAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (data)\r\n        {\r\n            var test = JSON.stringify(data);\r\n\r\n            if (test.length > 1000)\r\n            {\r\n                console.warn('Switch Game data too long. Max 1000 chars.');\r\n                return this;\r\n            }\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.switchGameAsync(appID, data).then(function ()\r\n        {\r\n            _this.emit('switchgame', appID);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            _this.emit('switchgamefail', e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Prompts the user to create a shortcut to the game if they are eligible to.\r\n     * Can only be called once per session.\r\n     * \r\n     * It makes an async call to the API, so the result isn't available immediately.\r\n     * \r\n     * If the user choose to create a shortcut this plugin will emit the `shortcutcreated` event.\r\n     * \r\n     * If they cannot, i.e. it's not in the list of supported APIs, or the request\r\n     * was rejected, it will emit a `shortcutcreatedfail` event instead.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#createShortcut\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    createShortcut: function ()\r\n    {\r\n        var _this = this;\r\n\r\n        FBInstant.canCreateShortcutAsync().then(function (canCreateShortcut)\r\n        {\r\n            if (canCreateShortcut)\r\n            {\r\n                FBInstant.createShortcutAsync().then(function ()\r\n                {\r\n                    _this.emit('shortcutcreated');\r\n\r\n                }).catch(function (e)\r\n                {\r\n                    _this.emit('shortcutfailed', e);\r\n                });\r\n            }\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Quits the game.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#quit\r\n     * @since 3.13.0\r\n     */\r\n    quit: function ()\r\n    {\r\n        FBInstant.quit();\r\n    },\r\n\r\n    /**\r\n     * Log an app event with FB Analytics.\r\n     * \r\n     * See https://developers.facebook.com/docs/javascript/reference/v2.8#app_events for more details about FB Analytics.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#log\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} name - Name of the event. Must be 2 to 40 characters, and can only contain '_', '-', ' ', and alphanumeric characters.\r\n     * @param {number} [value] - An optional numeric value that FB Analytics can calculate a sum with.\r\n     * @param {object} [params] - An optional object that can contain up to 25 key-value pairs to be logged with the event. Keys must be 2 to 40 characters, and can only contain '_', '-', ' ', and alphanumeric characters. Values must be less than 100 characters in length.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    log: function (name, value, params)\r\n    {\r\n        if (!this.checkAPI('logEvent'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (params === undefined) { params = {}; }\r\n\r\n        if (name.length >= 2 && name.length <= 40)\r\n        {\r\n            FBInstant.logEvent(name, parseFloat(value), params);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Attempt to create an instance of an interstitial ad.\r\n     * \r\n     * If the instance is created successfully then the ad is preloaded ready for display in-game via the method `showAd()`.\r\n     * \r\n     * If the ad loads it will emit the `adloaded` event, passing the AdInstance as the only parameter.\r\n     * \r\n     * If the ad cannot be displayed because there was no inventory to fill it, it will emit the `adsnofill` event.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#preloadAds\r\n     * @since 3.13.0\r\n     * \r\n     * @param {(string|string[])} placementID - The ad placement ID, or an array of IDs, as created in your Audience Network settings within Facebook.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    preloadAds: function (placementID)\r\n    {\r\n        if (!this.checkAPI('getInterstitialAdAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (!Array.isArray(placementID))\r\n        {\r\n            placementID = [ placementID ];\r\n        }\r\n\r\n        var i;\r\n        var _this = this;\r\n\r\n        var total = 0;\r\n\r\n        for (i = 0; i < this.ads.length; i++)\r\n        {\r\n            if (!this.ads[i].shown)\r\n            {\r\n                total++;\r\n            }\r\n        }\r\n\r\n        if (total + placementID.length >= 3)\r\n        {\r\n            console.warn('Too many AdInstances. Show an ad before loading more');\r\n            return this;\r\n        }\r\n\r\n        for (i = 0; i < placementID.length; i++)\r\n        {\r\n            var id = placementID[i];\r\n            var data;\r\n\r\n            FBInstant.getInterstitialAdAsync(id).then(function (interstitial)\r\n            {\r\n                data = interstitial;\r\n\r\n                return interstitial.loadAsync();\r\n\r\n            }).then(function ()\r\n            {\r\n                var ad = AdInstance(id, data, false);\r\n\r\n                _this.ads.push(ad);\r\n\r\n                _this.emit('adloaded', ad);\r\n\r\n            }).catch(function (e)\r\n            {\r\n                if (e.code === 'ADS_NO_FILL')\r\n                {\r\n                    _this.emit('adsnofill', id);\r\n                }\r\n                else if (e.code === 'ADS_FREQUENT_LOAD')\r\n                {\r\n                    _this.emit('adsfrequentload', id);\r\n                }\r\n                else\r\n                {\r\n                    console.warn(e);\r\n                }\r\n            });\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Attempt to create an instance of an rewarded video ad.\r\n     * \r\n     * If the instance is created successfully then the ad is preloaded ready for display in-game via the method `showVideo()`.\r\n     * \r\n     * If the ad loads it will emit the `adloaded` event, passing the AdInstance as the only parameter.\r\n     * \r\n     * If the ad cannot be displayed because there was no inventory to fill it, it will emit the `adsnofill` event.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#preloadVideoAds\r\n     * @since 3.13.0\r\n     * \r\n     * @param {(string|string[])} placementID - The ad placement ID, or an array of IDs, as created in your Audience Network settings within Facebook.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    preloadVideoAds: function (placementID)\r\n    {\r\n        if (!this.checkAPI('getRewardedVideoAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (!Array.isArray(placementID))\r\n        {\r\n            placementID = [ placementID ];\r\n        }\r\n\r\n        var i;\r\n        var _this = this;\r\n\r\n        var total = 0;\r\n\r\n        for (i = 0; i < this.ads.length; i++)\r\n        {\r\n            if (!this.ads[i].shown)\r\n            {\r\n                total++;\r\n            }\r\n        }\r\n\r\n        if (total + placementID.length >= 3)\r\n        {\r\n            console.warn('Too many AdInstances. Show an ad before loading more');\r\n            return this;\r\n        }\r\n\r\n        for (i = 0; i < placementID.length; i++)\r\n        {\r\n            var id = placementID[i];\r\n            var data;\r\n\r\n            FBInstant.getRewardedVideoAsync(id).then(function (reward)\r\n            {\r\n                data = reward;\r\n\r\n                return reward.loadAsync();\r\n\r\n            }).then(function ()\r\n            {\r\n                var ad = AdInstance(id, data, true);\r\n\r\n                _this.ads.push(ad);\r\n\r\n                _this.emit('adloaded', ad);\r\n\r\n            }).catch(function (e)\r\n            {\r\n                if (e.code === 'ADS_NO_FILL')\r\n                {\r\n                    _this.emit('adsnofill', id);\r\n                }\r\n                else if (e.code === 'ADS_FREQUENT_LOAD')\r\n                {\r\n                    _this.emit('adsfrequentload', id);\r\n                }\r\n                else\r\n                {\r\n                    console.warn(e);\r\n                }\r\n            });\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Displays a previously loaded interstitial ad.\r\n     * \r\n     * If the ad is successfully displayed this plugin will emit the `adfinished` event, with the AdInstance object as its parameter.\r\n     * \r\n     * If the ad cannot be displayed, it will emit the `adsnotloaded` event.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#showAd\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} placementID - The ad placement ID to display.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    showAd: function (placementID)\r\n    {\r\n        var _this = this;\r\n\r\n        for (var i = 0; i < this.ads.length; i++)\r\n        {\r\n            var ad = this.ads[i];\r\n\r\n            if (ad.placementID === placementID && !ad.shown)\r\n            {\r\n                ad.instance.showAsync().then(function ()\r\n                {\r\n                    ad.shown = true;\r\n\r\n                    _this.emit('adfinished', ad);\r\n\r\n                }).catch(function (e)\r\n                {\r\n                    if (e.code === 'ADS_NOT_LOADED')\r\n                    {\r\n                        _this.emit('adsnotloaded', ad);\r\n                    }\r\n                    else if (e.code === 'RATE_LIMITED')\r\n                    {\r\n                        _this.emit('adratelimited', ad);\r\n                    }\r\n                    \r\n                    _this.emit('adshowerror', e, ad);\r\n                });\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Displays a previously loaded interstitial video ad.\r\n     * \r\n     * If the ad is successfully displayed this plugin will emit the `adfinished` event, with the AdInstance object as its parameter.\r\n     * \r\n     * If the ad cannot be displayed, it will emit the `adsnotloaded` event.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#showVideo\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} placementID - The ad placement ID to display.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    showVideo: function (placementID)\r\n    {\r\n        var _this = this;\r\n\r\n        for (var i = 0; i < this.ads.length; i++)\r\n        {\r\n            var ad = this.ads[i];\r\n\r\n            if (ad.placementID === placementID && ad.video && !ad.shown)\r\n            {\r\n                ad.instance.showAsync().then(function ()\r\n                {\r\n                    ad.shown = true;\r\n\r\n                    _this.emit('adfinished', ad);\r\n\r\n                }).catch(function (e)\r\n                {\r\n                    if (e.code === 'ADS_NOT_LOADED')\r\n                    {\r\n                        _this.emit('adsnotloaded', ad);\r\n                    }\r\n                    else if (e.code === 'RATE_LIMITED')\r\n                    {\r\n                        _this.emit('adratelimited', ad);\r\n                    }\r\n                    \r\n                    _this.emit('adshowerror', e, ad);\r\n                });\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Attempts to match the current player with other users looking for people to play with.\r\n     * If successful, a new Messenger group thread will be created containing the matched players and the player will\r\n     * be context switched to that thread. This plugin will also dispatch the `matchplayer` event, containing the new context ID and Type.\r\n     * \r\n     * The default minimum and maximum number of players in one matched thread are 2 and 20 respectively,\r\n     * depending on how many players are trying to get matched around the same time.\r\n     * \r\n     * The values can be changed in `fbapp-config.json`. See the Bundle Config documentation for documentation about `fbapp-config.json`.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#matchPlayer\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} [matchTag] - Optional extra information about the player used to group them with similar players. Players will only be grouped with other players with exactly the same tag. The tag must only include letters, numbers, and underscores and be 100 characters or less in length.\r\n     * @param {boolean} [switchImmediately=false] - Optional extra parameter that specifies whether the player should be immediately switched to the new context when a match is found. By default this will be false which will mean the player needs explicitly press play after being matched to switch to the new context.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    matchPlayer: function (matchTag, switchImmediately)\r\n    {\r\n        if (matchTag === undefined) { matchTag = null; }\r\n        if (switchImmediately === undefined) { switchImmediately = false; }\r\n\r\n        if (!this.checkAPI('matchPlayerAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.matchPlayerAsync(matchTag, switchImmediately).then(function ()\r\n        {\r\n            _this.getID();\r\n            _this.getType();\r\n\r\n            _this.emit('matchplayer', _this.contextID, _this.contextType);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Fetch a specific leaderboard belonging to this Instant Game.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes the `getleaderboard` event will be emitted along with a Leaderboard object instance.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#getLeaderboard\r\n     * @since 3.13.0\r\n     * \r\n     * @param {string} name - The name of the leaderboard. Each leaderboard for an Instant Game must have its own distinct name.\r\n     * \r\n     * @return {this} This Facebook Instant Games Plugin instance.\r\n     */\r\n    getLeaderboard: function (name)\r\n    {\r\n        if (!this.checkAPI('getLeaderboardAsync'))\r\n        {\r\n            return this;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        FBInstant.getLeaderboardAsync(name).then(function (data)\r\n        {\r\n            var leaderboard = new Leaderboard(_this, data);\r\n\r\n            _this.leaderboards[name] = leaderboard;\r\n\r\n            _this.emit('getleaderboard', leaderboard);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Quits the Facebook API and then destroys this plugin.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesPlugin#destroy\r\n     * @since 3.13.0\r\n     */\r\n    destroy: function ()\r\n    {\r\n        FBInstant.quit();\r\n\r\n        this.data.destroy();\r\n\r\n        this.removeAllListeners();\r\n\r\n        this.catalog = [];\r\n        this.purchases = [];\r\n        this.leaderboards = [];\r\n        this.ads = [];\r\n\r\n        this.game = null;\r\n    }\r\n\r\n});\r\n\r\nmodule.exports = FacebookInstantGamesPlugin;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Class = require('../../../src/utils/Class');\r\nvar EventEmitter = require('eventemitter3');\r\nvar LeaderboardScore = require('./LeaderboardScore');\r\n\r\n/**\r\n * @classdesc\r\n * This class represents one single Leaderboard that belongs to a Facebook Instant Game.\r\n * \r\n * You do not need to instantiate this class directly, it will be created when you use the\r\n * `getLeaderboard()` method of the main plugin.\r\n *\r\n * @class FacebookInstantGamesLeaderboard\r\n * @memberOf Phaser\r\n * @constructor\r\n * @extends Phaser.Events.EventEmitter\r\n * @since 3.13.0\r\n * \r\n * @param {Phaser.FacebookInstantGamesPlugin} plugin - A reference to the Facebook Instant Games Plugin.\r\n * @param {any} data - An Instant Game leaderboard instance.\r\n */\r\nvar Leaderboard = new Class({\r\n\r\n    Extends: EventEmitter,\r\n\r\n    initialize:\r\n\r\n    function Leaderboard (plugin, data)\r\n    {\r\n        EventEmitter.call(this);\r\n\r\n        /**\r\n         * A reference to the Facebook Instant Games Plugin.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#plugin\r\n         * @type {Phaser.FacebookInstantGamesPlugin}\r\n         * @since 3.13.0\r\n         */\r\n        this.plugin = plugin;\r\n\r\n        /**\r\n         * An Instant Game leaderboard instance.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#ref\r\n         * @type {any}\r\n         * @since 3.13.0\r\n         */\r\n        this.ref = data;\r\n\r\n        /**\r\n         * The name of the leaderboard.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#name\r\n         * @type {string}\r\n         * @since 3.13.0\r\n         */\r\n        this.name = data.getName();\r\n\r\n        /**\r\n         * The ID of the context that the leaderboard is associated with, or null if the leaderboard is not tied to a particular context.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#contextID\r\n         * @type {string}\r\n         * @since 3.13.0\r\n         */\r\n        this.contextID = data.getContextID();\r\n\r\n        /**\r\n         * The total number of player entries in the leaderboard.\r\n         * This value defaults to zero. Populate it via the `getEntryCount()` method.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#entryCount\r\n         * @type {integer}\r\n         * @since 3.13.0\r\n         */\r\n        this.entryCount = 0;\r\n\r\n        /**\r\n         * The players score object.\r\n         * This value defaults to `null`. Populate it via the `getPlayerScore()` method.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#playerScore\r\n         * @type {LeaderboardScore}\r\n         * @since 3.13.0\r\n         */\r\n        this.playerScore = null;\r\n\r\n        /**\r\n         * The scores in the Leaderboard from the currently requested range.\r\n         * This value defaults to an empty array. Populate it via the `getScores()` method.\r\n         * The contents of this array are reset each time `getScores()` is called.\r\n         *\r\n         * @name Phaser.FacebookInstantGamesLeaderboard#scores\r\n         * @type {LeaderboardScore[]}\r\n         * @since 3.13.0\r\n         */\r\n        this.scores = [];\r\n\r\n        this.getEntryCount();\r\n    },\r\n\r\n    /**\r\n     * Fetches the total number of player entries in the leaderboard.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes this Leaderboard will emit the `getentrycount` event along with the count and name of the Leaderboard.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesLeaderboard#getEntryCount\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Leaderboard instance.\r\n     */\r\n    getEntryCount: function ()\r\n    {\r\n        var _this = this;\r\n\r\n        this.ref.getEntryCountAsync().then(function (count)\r\n        {\r\n            _this.entryCount = count;\r\n\r\n            _this.emit('getentrycount', count, _this.name);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Updates the player's score. If the player has an existing score, the old score will only be replaced if the new score is better than it.\r\n     * NOTE: If the leaderboard is associated with a specific context, the game must be in that context to set a score for the player.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes this Leaderboard will emit the `setscore` event along with the LeaderboardScore object and the name of the Leaderboard.\r\n     * \r\n     * If the save fails the event will send `null` as the score value.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesLeaderboard#setScore\r\n     * @since 3.13.0\r\n     * \r\n     * @param {integer} score - The new score for the player. Must be a 64-bit integer number.\r\n     * @param {(string|any)} [data] - Metadata to associate with the stored score. Must be less than 2KB in size. If an object is given it will be passed to `JSON.stringify`.\r\n     * \r\n     * @return {this} This Leaderboard instance.\r\n     */\r\n    setScore: function (score, data)\r\n    {\r\n        if (data === undefined) { data = ''; }\r\n\r\n        if (typeof data === 'object')\r\n        {\r\n            data = JSON.stringify(data);\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        this.ref.setScoreAsync(score, data).then(function (entry)\r\n        {\r\n            if (entry)\r\n            {\r\n                var score = LeaderboardScore(entry);\r\n\r\n                _this.playerScore = score;\r\n    \r\n                _this.emit('setscore', score, _this.name);\r\n            }\r\n            else\r\n            {\r\n                _this.emit('setscore', null, _this.name);\r\n            }\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Gets the players leaderboard entry and stores it in the `playerScore` property.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes this Leaderboard will emit the `getplayerscore` event along with the score and the name of the Leaderboard.\r\n     * \r\n     * If the player has not yet saved a score, the event will send `null` as the score value, and `playerScore` will be set to `null` as well.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesLeaderboard#getPlayerScore\r\n     * @since 3.13.0\r\n     * \r\n     * @return {this} This Leaderboard instance.\r\n     */\r\n    getPlayerScore: function ()\r\n    {\r\n        var _this = this;\r\n\r\n        this.ref.getPlayerEntryAsync().then(function (entry)\r\n        {\r\n            if (entry)\r\n            {\r\n                var score = LeaderboardScore(entry);\r\n\r\n                _this.playerScore = score;\r\n    \r\n                _this.emit('getplayerscore', score, _this.name);\r\n            }\r\n            else\r\n            {\r\n                _this.emit('getplayerscore', null, _this.name);\r\n            }\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Retrieves a set of leaderboard entries, ordered by score ranking in the leaderboard.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes this Leaderboard will emit the `getscores` event along with an array of LeaderboardScore entries and the name of the Leaderboard.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesLeaderboard#getScores\r\n     * @since 3.13.0\r\n     * \r\n     * @param {integer} [count=10] - The number of entries to attempt to fetch from the leaderboard. Currently, up to a maximum of 100 entries may be fetched per query.\r\n     * @param {integer} [offset=0] - The offset from the top of the leaderboard that entries will be fetched from.\r\n     * \r\n     * @return {this} This Leaderboard instance.\r\n     */\r\n    getScores: function (count, offset)\r\n    {\r\n        if (count === undefined) { count = 10; }\r\n        if (offset === undefined) { offset = 0; }\r\n\r\n        var _this = this;\r\n\r\n        this.ref.getEntriesAsync(count, offset).then(function (entries)\r\n        {\r\n            _this.scores = [];\r\n\r\n            entries.forEach(function (entry)\r\n            {\r\n                _this.scores.push(LeaderboardScore(entry));\r\n            });\r\n\r\n            _this.emit('getscores', _this.scores, _this.name);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Retrieves a set of leaderboard entries, based on the current player's connected players (including the current player), ordered by local rank within the set of connected players.\r\n     * \r\n     * The data is requested in an async call, so the result isn't available immediately.\r\n     * \r\n     * When the call completes this Leaderboard will emit the `getconnectedscores` event along with an array of LeaderboardScore entries and the name of the Leaderboard.\r\n     *\r\n     * @method Phaser.FacebookInstantGamesLeaderboard#getConnectedScores\r\n     * @since 3.16.0\r\n     * \r\n     * @return {this} This Leaderboard instance.\r\n     */\r\n    getConnectedScores: function ()\r\n    {\r\n        var _this = this;\r\n\r\n        this.ref.getConnectedPlayerEntriesAsync().then(function (entries)\r\n        {\r\n            _this.scores = [];\r\n\r\n            entries.forEach(function (entry)\r\n            {\r\n                _this.scores.push(LeaderboardScore(entry));\r\n            });\r\n\r\n            _this.emit('getconnectedscores', _this.scores, _this.name);\r\n\r\n        }).catch(function (e)\r\n        {\r\n            console.warn(e);\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n});\r\n\r\nmodule.exports = Leaderboard;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * @typedef {object} LeaderboardScore\r\n *\r\n * @property {integer} score - An integer score value.\r\n * @property {string} scoreFormatted - The score value, formatted with the score format associated with the leaderboard.\r\n * @property {integer} timestamp - The Unix timestamp of when the leaderboard entry was last updated.\r\n * @property {integer} rank - The entry's leaderboard ranking.\r\n * @property {string} data - The developer-specified payload associated with the score, or null if one was not set.\r\n * @property {string} playerName - The player's localized display name.\r\n * @property {string} playerPhotoURL -  A url to the player's public profile photo.\r\n * @property {string} playerID - The game's unique identifier for the player.\r\n */\r\n\r\nvar LeaderboardScore = function (entry)\r\n{\r\n    return {\r\n        score: entry.getScore(),\r\n        scoreFormatted: entry.getFormattedScore(),\r\n        timestamp: entry.getTimestamp(),\r\n        rank: entry.getRank(),\r\n        data: entry.getExtraData(),\r\n        playerName: entry.getPlayer().getName(),\r\n        playerPhotoURL: entry.getPlayer().getPhoto(),\r\n        playerID: entry.getPlayer().getID()\r\n    };\r\n};\r\n\r\nmodule.exports = LeaderboardScore;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar GetFastValue = require('../../../src/utils/object/GetFastValue');\r\n\r\n/**\r\n * @typedef {object} Product\r\n *\r\n * @property {string} [title] - The title of the product.\r\n * @property {string} [productID] - The product's game-specified identifier.\r\n * @property {string} [description] - The product description.\r\n * @property {string} [imageURI] - A link to the product's associated image.\r\n * @property {string} [price] - The price of the product.\r\n * @property {string} [priceCurrencyCode] - The currency code for the product.\r\n */\r\n\r\nvar Product = function (data)\r\n{\r\n    return {\r\n        title: GetFastValue(data, 'title', ''),\r\n        productID: GetFastValue(data, 'productID', ''),\r\n        description: GetFastValue(data, 'description', ''),\r\n        imageURI: GetFastValue(data, 'imageURI', ''),\r\n        price: GetFastValue(data, 'price', ''),\r\n        priceCurrencyCode: GetFastValue(data, 'priceCurrencyCode', '')\r\n    };\r\n};\r\n\r\nmodule.exports = Product;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar GetFastValue = require('../../../src/utils/object/GetFastValue');\r\n\r\n/**\r\n * @typedef {object} Purchase\r\n *\r\n * @property {string} [developerPayload] - A developer-specified string, provided during the purchase of the product.\r\n * @property {string} [paymentID] - The identifier for the purchase transaction.\r\n * @property {string} [productID] - The product's game-specified identifier.\r\n * @property {string} [purchaseTime] - Unix timestamp of when the purchase occurred.\r\n * @property {string} [purchaseToken] - A token representing the purchase that may be used to consume the purchase.\r\n * @property {string} [signedRequest] - Server-signed encoding of the purchase request.\r\n */\r\n\r\nvar Purchase = function (data)\r\n{\r\n    return {\r\n        developerPayload: GetFastValue(data, 'developerPayload', ''),\r\n        paymentID: GetFastValue(data, 'paymentID', ''),\r\n        productID: GetFastValue(data, 'productID', ''),\r\n        purchaseTime: GetFastValue(data, 'purchaseTime', ''),\r\n        purchaseToken: GetFastValue(data, 'purchaseToken', ''),\r\n        signedRequest: GetFastValue(data, 'signedRequest', '')\r\n    };\r\n};\r\n\r\nmodule.exports = Purchase;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n//  Taken from klasse by mattdesl https://github.com/mattdesl/klasse\r\n\r\nfunction hasGetterOrSetter (def)\r\n{\r\n    return (!!def.get && typeof def.get === 'function') || (!!def.set && typeof def.set === 'function');\r\n}\r\n\r\nfunction getProperty (definition, k, isClassDescriptor)\r\n{\r\n    //  This may be a lightweight object, OR it might be a property that was defined previously.\r\n\r\n    //  For simple class descriptors we can just assume its NOT previously defined.\r\n    var def = (isClassDescriptor) ? definition[k] : Object.getOwnPropertyDescriptor(definition, k);\r\n\r\n    if (!isClassDescriptor && def.value && typeof def.value === 'object')\r\n    {\r\n        def = def.value;\r\n    }\r\n\r\n    //  This might be a regular property, or it may be a getter/setter the user defined in a class.\r\n    if (def && hasGetterOrSetter(def))\r\n    {\r\n        if (typeof def.enumerable === 'undefined')\r\n        {\r\n            def.enumerable = true;\r\n        }\r\n\r\n        if (typeof def.configurable === 'undefined')\r\n        {\r\n            def.configurable = true;\r\n        }\r\n\r\n        return def;\r\n    }\r\n    else\r\n    {\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction hasNonConfigurable (obj, k)\r\n{\r\n    var prop = Object.getOwnPropertyDescriptor(obj, k);\r\n\r\n    if (!prop)\r\n    {\r\n        return false;\r\n    }\r\n\r\n    if (prop.value && typeof prop.value === 'object')\r\n    {\r\n        prop = prop.value;\r\n    }\r\n\r\n    if (prop.configurable === false)\r\n    {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Extends the given `myClass` object's prototype with the properties of `definition`.\r\n *\r\n * @function extend\r\n * @ignore\r\n * @param {Object} ctor The constructor object to mix into.\r\n * @param {Object} definition A dictionary of functions for the class.\r\n * @param {boolean} isClassDescriptor Is the definition a class descriptor?\r\n * @param {Object} [extend] The parent constructor object.\r\n */\r\nfunction extend (ctor, definition, isClassDescriptor, extend)\r\n{\r\n    for (var k in definition)\r\n    {\r\n        if (!definition.hasOwnProperty(k))\r\n        {\r\n            continue;\r\n        }\r\n\r\n        var def = getProperty(definition, k, isClassDescriptor);\r\n\r\n        if (def !== false)\r\n        {\r\n            //  If Extends is used, we will check its prototype to see if the final variable exists.\r\n\r\n            var parent = extend || ctor;\r\n\r\n            if (hasNonConfigurable(parent.prototype, k))\r\n            {\r\n                //  Just skip the final property\r\n                if (Class.ignoreFinals)\r\n                {\r\n                    continue;\r\n                }\r\n\r\n                //  We cannot re-define a property that is configurable=false.\r\n                //  So we will consider them final and throw an error. This is by\r\n                //  default so it is clear to the developer what is happening.\r\n                //  You can set ignoreFinals to true if you need to extend a class\r\n                //  which has configurable=false; it will simply not re-define final properties.\r\n                throw new Error('cannot override final property \\'' + k + '\\', set Class.ignoreFinals = true to skip');\r\n            }\r\n\r\n            Object.defineProperty(ctor.prototype, k, def);\r\n        }\r\n        else\r\n        {\r\n            ctor.prototype[k] = definition[k];\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Applies the given `mixins` to the prototype of `myClass`.\r\n *\r\n * @function mixin\r\n * @ignore\r\n * @param {Object} myClass The constructor object to mix into.\r\n * @param {Object|Array<Object>} mixins The mixins to apply to the constructor.\r\n */\r\nfunction mixin (myClass, mixins)\r\n{\r\n    if (!mixins)\r\n    {\r\n        return;\r\n    }\r\n\r\n    if (!Array.isArray(mixins))\r\n    {\r\n        mixins = [ mixins ];\r\n    }\r\n\r\n    for (var i = 0; i < mixins.length; i++)\r\n    {\r\n        extend(myClass, mixins[i].prototype || mixins[i]);\r\n    }\r\n}\r\n\r\n/**\r\n * Creates a new class with the given descriptor.\r\n * The constructor, defined by the name `initialize`,\r\n * is an optional function. If unspecified, an anonymous\r\n * function will be used which calls the parent class (if\r\n * one exists).\r\n *\r\n * You can also use `Extends` and `Mixins` to provide subclassing\r\n * and inheritance.\r\n *\r\n * @class Phaser.Class\r\n * @constructor\r\n * @param {Object} definition a dictionary of functions for the class\r\n * @example\r\n *\r\n *      var MyClass = new Phaser.Class({\r\n *\r\n *          initialize: function() {\r\n *              this.foo = 2.0;\r\n *          },\r\n *\r\n *          bar: function() {\r\n *              return this.foo + 5;\r\n *          }\r\n *      });\r\n */\r\nfunction Class (definition)\r\n{\r\n    if (!definition)\r\n    {\r\n        definition = {};\r\n    }\r\n\r\n    //  The variable name here dictates what we see in Chrome debugger\r\n    var initialize;\r\n    var Extends;\r\n\r\n    if (definition.initialize)\r\n    {\r\n        if (typeof definition.initialize !== 'function')\r\n        {\r\n            throw new Error('initialize must be a function');\r\n        }\r\n\r\n        initialize = definition.initialize;\r\n\r\n        //  Usually we should avoid 'delete' in V8 at all costs.\r\n        //  However, its unlikely to make any performance difference\r\n        //  here since we only call this on class creation (i.e. not object creation).\r\n        delete definition.initialize;\r\n    }\r\n    else if (definition.Extends)\r\n    {\r\n        var base = definition.Extends;\r\n\r\n        initialize = function ()\r\n        {\r\n            base.apply(this, arguments);\r\n        };\r\n    }\r\n    else\r\n    {\r\n        initialize = function () {};\r\n    }\r\n\r\n    if (definition.Extends)\r\n    {\r\n        initialize.prototype = Object.create(definition.Extends.prototype);\r\n        initialize.prototype.constructor = initialize;\r\n\r\n        //  For getOwnPropertyDescriptor to work, we need to act directly on the Extends (or Mixin)\r\n\r\n        Extends = definition.Extends;\r\n\r\n        delete definition.Extends;\r\n    }\r\n    else\r\n    {\r\n        initialize.prototype.constructor = initialize;\r\n    }\r\n\r\n    //  Grab the mixins, if they are specified...\r\n    var mixins = null;\r\n\r\n    if (definition.Mixins)\r\n    {\r\n        mixins = definition.Mixins;\r\n        delete definition.Mixins;\r\n    }\r\n\r\n    //  First, mixin if we can.\r\n    mixin(initialize, mixins);\r\n\r\n    //  Now we grab the actual definition which defines the overrides.\r\n    extend(initialize, definition, true, Extends);\r\n\r\n    return initialize;\r\n}\r\n\r\nClass.extend = extend;\r\nClass.mixin = mixin;\r\nClass.ignoreFinals = false;\r\n\r\nmodule.exports = Class;\r\n","/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * Finds the key within the top level of the {@link source} object, or returns {@link defaultValue}\r\n *\r\n * @function Phaser.Utils.Objects.GetFastValue\r\n * @since 3.0.0\r\n *\r\n * @param {object} source - The object to search\r\n * @param {string} key - The key for the property on source. Must exist at the top level of the source object (no periods)\r\n * @param {*} [defaultValue] - The default value to use if the key does not exist.\r\n *\r\n * @return {*} The value if found; otherwise, defaultValue (null if none provided)\r\n */\r\nvar GetFastValue = function (source, key, defaultValue)\r\n{\r\n    var t = typeof(source);\r\n\r\n    if (!source || t === 'number' || t === 'string')\r\n    {\r\n        return defaultValue;\r\n    }\r\n    else if (source.hasOwnProperty(key) && source[key] !== undefined)\r\n    {\r\n        return source[key];\r\n    }\r\n    else\r\n    {\r\n        return defaultValue;\r\n    }\r\n};\r\n\r\nmodule.exports = GetFastValue;\r\n"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","exports","placementID","instance","video","shown","AdInstance","Class","DataManager","Leaderboard","Product","Purchase","FacebookInstantGamesPlugin","Extends","initialize","game","data","setDataHandler","changeDataHandler","hasLoaded","dataLocked","supportedAPIs","entryPoint","entryPointData","contextID","contextType","locale","platform","version","playerID","playerName","playerPhotoURL","playerCanSubscribeBot","paymentsReady","catalog","purchases","leaderboards","ads","parent","key","value","_this","FBInstant","player","setDataAsync","then","showLoadProgress","scene","load","setLoadingProgress","startGameAsync","gameStartedHandler","bind","gameStarted","APIs","getSupportedAPIs","supported","dotToUpper","match","toUpperCase","forEach","api","replace","getID","getType","getLocale","getPlatform","getSDKVersion","getPlayerID","getPlayerName","getPlayerPhotoURL","onPause","getEntryPointAsync","entrypoint","getEntryPointData","catch","e","console","warn","paymentsPurchaseAsync","payments","onReady","checkAPI","contextGetID","contextGetType","playerGetID","playerGetName","getName","playerGetPhoto","getPhoto","loadPlayerPhoto","setCORS","image","start","canSubscribeBot","playerCanSubscribeBotAsync","canSubscribeBotAsync","subscribeBot","subscribeBotAsync","getData","keys","isArray","getDataAsync","set","saveData","flushData","flushDataAsync","getStats","getStatsAsync","saveStats","output","setStatsAsync","incStats","incrementStatsAsync","stats","saveSession","JSON","stringify","setSessionData","openShare","text","frame","sessionData","_share","openInvite","openRequest","openChallenge","intent","imageData","textures","getBase64","payload","shareAsync","isSizeBetween","min","max","switchContext","switchAsync","chooseContext","options","chooseAsync","createContext","createAsync","getPlayers","getConnectedPlayersAsync","players","getCatalog","getCatalogAsync","item","getProduct","productID","purchase","developerPayload","config","purchaseAsync","getPurchases","getPurchasesAsync","consumePurchase","purchaseToken","consumePurchaseAsync","update","cta","template","updateData","_update","updateLeaderboard","action","default","strategy","notification","updateAsync","switchGame","appID","switchGameAsync","createShortcut","canCreateShortcutAsync","canCreateShortcut","createShortcutAsync","quit","log","params","logEvent","parseFloat","preloadAds","total","id","getInterstitialAdAsync","interstitial","loadAsync","ad","code","preloadVideoAds","getRewardedVideoAsync","reward","showAd","showAsync","showVideo","matchPlayer","matchTag","switchImmediately","matchPlayerAsync","getLeaderboard","getLeaderboardAsync","leaderboard","destroy","LeaderboardScore","plugin","ref","getContextID","entryCount","playerScore","scores","getEntryCount","getEntryCountAsync","count","setScore","score","setScoreAsync","entry","getPlayerScore","getPlayerEntryAsync","getScores","offset","getEntriesAsync","entries","getConnectedScores","getConnectedPlayerEntriesAsync","getScore","scoreFormatted","getFormattedScore","timestamp","getTimestamp","rank","getRank","getExtraData","getPlayer","GetFastValue","title","description","imageURI","price","priceCurrencyCode","paymentID","purchaseTime","signedRequest","getProperty","definition","k","isClassDescriptor","def","getOwnPropertyDescriptor","get","hasGetterOrSetter","enumerable","configurable","hasNonConfigurable","obj","prop","extend","ctor","ignoreFinals","Error","defineProperty","mixin","myClass","mixins","base","constructor","Mixins","source","defaultValue","t"],"sourceRoot":""}